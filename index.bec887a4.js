!function(){function t(e){return e.map(function(e){return Array.isArray(e)?t(e):e})}var e=new(function(){var e;function n(e){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,n),this.score=0,this.status="idle",this.initialState=t(e||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]),this.board=t(this.initialState)}return e=[{key:"addNewCell",value:function(){for(var t=[],e=0;e<4;e++)for(var n=0;n<4;n++)0===this.board[e][n]&&t.push({row:e,col:n});if(t.length>0){var r=t[Math.floor(Math.random()*t.length)],a=r.row,o=r.col;this.board[a][o]=.9>Math.random()?2:4}}},{key:"moveLeft",value:function(){"playing"===this.status&&this.move(function(t){return t},function(t,e,n){for(var r=0;r<4;r++)t[n][r]=e[r]})}},{key:"moveRight",value:function(){"playing"===this.status&&this.move(function(t){return t.slice().reverse()},function(t,e,n){for(var r=0;r<4;r++)t[n][r]=e[3-r]})}},{key:"moveUp",value:function(){var t=this;"playing"===this.status&&this.move(function(e,n){return t.board.map(function(t){return t[n]})},function(t,e,n){for(var r=0;r<4;r++)t[r][n]=e[r]})}},{key:"moveDown",value:function(){var t=this;"playing"===this.status&&this.move(function(e,n){return t.board.map(function(t){return t[n]}).reverse()},function(t,e,n){e.reverse();for(var r=0;r<4;r++)t[r][n]=e[r]})}},{key:"move",value:function(t,e){for(var n=!1,r=0;r<4;r++){var a=t(this.board[r],r),o=this.combine(a);o.join("")!==a.join("")&&(n=!0),e(this.board,o,r)}n&&(this.addNewCell(),this.checkGameStatus())}},{key:"combine",value:function(t){for(var e=t.filter(function(t){return 0!==t}),n=0,r=[],a=0;a<e.length;a++)e[a]===e[a+1]?(r.push(2*e[a]),n+=2*e[a],e[a+1]=0,a++):r.push(e[a]);for(this.score+=n;r.length<4;)r.push(0);return r}},{key:"checkGameStatus",value:function(){this.board.flat().includes(2048)?this.status="win":this.canMove()||(this.status="lose")}},{key:"canMove",value:function(){for(var t=0;t<4;t++)for(var e=0;e<4;e++)if(0===this.board[t][e]||3!==e&&this.board[t][e]===this.board[t][e+1]||3!==t&&this.board[t][e]===this.board[t+1][e])return!0;return!1}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){"idle"===this.status&&(this.status="playing",this.addNewCell(),this.addNewCell())}},{key:"restart",value:function(){this.board=t(this.initialState),this.score=0,this.status="idle"}}],function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(n.prototype,e),n}()),n={left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"};document.addEventListener("DOMContentLoaded",function(){var t=document.querySelector(".game-field"),r=document.querySelector(".game-score"),a=document.querySelector(".start"),o=document.querySelector(".message-start"),i=document.querySelector(".message-lose"),s=document.querySelector(".message-win");function u(){t.innerHTML="",e.getState().forEach(function(e){var n=document.createElement("tr");n.classList.add("field-row"),e.forEach(function(t){var e=document.createElement("td");e.classList.add("field-cell"),0!==t&&(e.classList.add("field-cell--".concat(t)),e.textContent=t),n.appendChild(e)}),t.appendChild(n)})}function c(){r.textContent=e.getScore()}function l(){o.classList.toggle("hidden","idle"!==e.getStatus()),i.classList.toggle("hidden","lose"!==e.getStatus()),s.classList.toggle("hidden","win"!==e.getStatus())}a.addEventListener("click",function(){"Start"===a.textContent?(e.start(),a.textContent="Restart",a.classList.replace("start","restart")):(e.restart(),c(0),a.textContent="Start",a.classList.replace("restart","start")),u(),c(),l()}),document.addEventListener("keydown",function(t){var r=t.key;if(Object.values(n).includes(r)){switch(t.preventDefault(),r){case n.left:e.moveLeft();break;case n.right:e.moveRight();break;case n.up:e.moveUp();break;case n.down:e.moveDown()}u(),c(),l()}})})}();
//# sourceMappingURL=index.bec887a4.js.map
